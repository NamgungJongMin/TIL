# CORS

교차 출처 리소스 공유 (Cross-Origin Resource Sharing, CORS)

## 1) 정의

추가 HTTP 헤더를 사용하여, 한 출처에서 실행 중인 웹 애플리케이션이 다른 출처의 선택한 자원에 접근할 수 있는 권한을 부여하도록 브라우저에 알려주는 체제.
웹 애플리케이션은 리소스가 자신의 출처와 다를 때 교차 출처 HTTP 요청을 실행함.

ex) https://domain-a.com의 프론트엔드 JavaScript 코드가 XMLHttpRequest를 사용하여 https://domain-b.com/data.json을 요청하는 경우

> CORS는 서로 다른 출처(Origin) 간에 리소스를 전달하는 방식을 제어하는 체제 / CORS 요청이 가능하려면 서버에서 특정 헤더인 Access-Control-Allow-Origin과 함께 응답해야 한다.

서로 다른 출처를 가진 상태에서 무언가를 요청하게 되면 브라우저가 보안상의 이유로 차단을 해버린다.

---

어디서 보내는 요청이 안되는가.

웹사이트에서 요청을 보낼 때마다 안된다는 것은 크롬이나 엣지 사파리 같은 브라우저에서 일어난다는 것. 프론트에서.

요청을 막는 것은 브라우저쪽.

---

엄밀히 말하면 CORS는 막힌걸 풀어주는 역할. SOP(Same-Origin Policy) 동일 출처 정책.

cors 다른 출처간의 요청을 허용해주는 것.

해결 방법 ) 요청을 받는 백엔드 쪽에서 이걸 허락할 다른 출처들을 미리 명시해두면 된다.

---

브라우저가 다른 출처끼리의 요청이 보내질 때는 요청에 Origin이라는 header를 추가한다.

header - 데이터가 다른 쪽으로 보내질 때 앞쪽에 붙는 데이터에 대한 보충 정보.
받는 쪽의 ip주소 사용할 프로토콜이나 옵션 등.

이 origin 항목에 scheme과 도메인 그리고 포트가 담김.
scheme 요청할 방법 (프로토콜).

이 요청을 받은 api서버는 답장의 헤더에 지정된 Access-Control-Allow-Origin 정보를 실어서 보내게 된다.

브라우저가 둘을 비교해서 Origin에 보낸것과 받은 ACAO 비교해서 둘다 있으면 요청 수락을 해주게 됨.

->> Simple Request - get post 조건에서 사용됨.

->> put delete 등의 다른 요청들은 본 요청을 보내기 전에 Prefligt 요청을 먼저 보내서 허락이 떨어져야 본격적으로 요청을 보낼 수 있음.
    보내는 것도 일단 허락을 받아야한다.